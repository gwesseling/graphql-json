# GraphQL JSON

GraphQL JSON is a powerful tool that helps you create GraphQL schemas using JSON. With an input schema based on the GraphQL type API, it should feel familiar to most users.

This package offers a TypeScript-typed solution for creating schemas for your GraphQL server, allowing you to take advantage of TypeScript to avoid errors. At the same time, it preserves the flexibility that GraphQL offers, enabling you to shape your schema to your liking.

The main goal of this package is to simplify the process of constructing GraphQL schemas. It helps you eliminate unnecessary clutter, making it easier to understand and modify your schemas. This way, you can reduce errors and build a reliable GraphQL API without the downsides of the GraphQL Types API or the GraphQL Schema Language.

## Usage

```javascript
const schemaInput = {...}

const schema = createSchema(schemaInput);

const server = new ApolloServer({
    schema: schema,
});
```

For a complete input example, please refer to the [example](#example) chapter below. This chapter contains a comprehensive JSON input, as well as the resulting output generated by the tool.

## Schema

### Base type

| Property    | Description              | Type                  | Required |
| ----------- | ------------------------ | --------------------- | -------- |
| description | description of your type | `string`              | No       |
| type        | The related GraphQL type | [GraphQLType](#types) | No       |

### Types

| Type                   | Description                                                                                |
| ---------------------- | ------------------------------------------------------------------------------------------ |
| GraphQLEnumType        | A GraphQL enum type                                                                        |
| GraphQLObjectType      | A GraphQL object type                                                                      |
| GraphQLScalarType      | A GraphQL scalar type                                                                      |
| GraphQLUnionType       | A GraphQL union type                                                                       |
| GraphQLInputObjectType | A GraphQL input object type                                                                |
| GraphQLInterfaceType   | A GraphQL interface type                                                                   |
| string                 | Either the name of a GraphQL type inside the schema or a [GraphQL type name](#named-types) |

### Named types

| Type      | Description                                                                |
| --------- | -------------------------------------------------------------------------- |
| enum      | A GraphQL enum type                                                        |
| object    | A GraphQL object type                                                      |
| scalar    | A GraphQL scalar type                                                      |
| union     | A GraphQL union type                                                       |
| input     | A GraphQL input object type                                                |
| interface | A GraphQL interface type                                                   |
| string    | Either the name of a GraphQL type inside the schema or a GraphQL type name |

### Input types

| Type                   | Description                                                                                |
| ---------------------- | ------------------------------------------------------------------------------------------ |
| GraphQLEnumType        | A GraphQL enum type                                                                        |
| GraphQLScalarType      | A GraphQL scalar type                                                                      |
| GraphQLInputObjectType | A GraphQL input object type                                                                |
| string                 | Either the name of a GraphQL type inside the schema or a [GraphQL type name](#named-types) |

### Output types

| Type                 | Description                                                                                |
| -------------------- | ------------------------------------------------------------------------------------------ |
| GraphQLEnumType      | A GraphQL enum type                                                                        |
| GraphQLObjectType    | A GraphQL object type                                                                      |
| GraphQLScalarType    | A GraphQL scalar type                                                                      |
| GraphQLUnionType     | A GraphQL union type                                                                       |
| GraphQLInterfaceType | A GraphQL interface type                                                                   |
| string               | Either the name of a GraphQL type inside the schema or a [GraphQL type name](#named-types) |

#### Enum type

| Property | Description                                         | Type     | Required |
| -------- | --------------------------------------------------- | -------- | -------- |
| values   | An object map with enum values (same as in GraphQL) | `Object` | Yes      |

#### Object type

| Property   | Description                                                  | Type                                                 | Required |
| ---------- | ------------------------------------------------------------ | ---------------------------------------------------- | -------- |
| interfaces | Array of interfaces to implement                             | `Array` (`string` or `GraphQLInterface`)             | No       |
| fields     | An object map of fields                                      | [Field type](#field-type)                            | Yes      |
| isTypeOf   | A function that helps resolve the GraphQL type of the object | `(value: any, info?: GraphQLResolveInfo) => boolean` | No       |

#### Input object type

| Property | Description             | Type                              | Required |
| -------- | ----------------------- | --------------------------------- | -------- |
| fields   | An object map of fields | [Field](#input-object-field-type) | Yes      |

#### Union type

| Property    | Description                                                  | Type                                                                                                                                       | Required |
| ----------- | ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------ | -------- |
| types       | Types to combine as an Union type                            | `GraphQLObjectType` or `string` (a GraphQL object inside the schema)                                                                       | Yes      |
| resolveType | A function that helps resolve the GraphQL type of the object | `(value: TSource, context: TContext, info: GraphQLResolveInfo, abstractType: GraphQLAbstractType, ) => PromiseOrValue<string / undefined>` | No       |

#### Interface type

| Property    | Description                                                  | Type                                                                                                                                       | Required |
| ----------- | ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------ | -------- |
| interfaces  | Array of interfaces to implement                             | `Array` (`string` or `GraphQLInterface`)                                                                                                   | No       |
| fields      | An object map of fields                                      | [Field type](#field-type)                                                                                                                  | Yes      |
| resolveType | A function that helps resolve the GraphQL type of the object | `(value: TSource, context: TContext, info: GraphQLResolveInfo, abstractType: GraphQLAbstractType, ) => PromiseOrValue<string / undefined>` | No       |

#### Scalar type

| Property       | Description                             | Type                                                                       | Required |
| -------------- | --------------------------------------- | -------------------------------------------------------------------------- | -------- |
| specifiedByURL | Scalar specification URL                | `string`                                                                   | No       |
| serialize      | Function to serialize the value to JSON | `(outputValue: unknown) => TExternal`                                      | No       |
| parseValue     | Function to parse the value             | `(inputValue: unknown) => TInternal;`                                      | No       |
| parseLiteral   | Function to partse the hard-coded AST   | `(valueNode: ValueNode, variables?: Maybe<ObjMap<unknown>>) => TInternal;` | No       |

### Sub types

#### Field type

| Property          | Description                        | Type                                                                                      | Required           |
| ----------------- | ---------------------------------- | ----------------------------------------------------------------------------------------- | ------------------ |
| type              | Type of the field                  | [Output type](#output-types) or `string` (a GraphQL type inside the schema)               | No\*               |
| list              | List item type                     | [List type](#field-list-type)                                                             | No\*               |
| required          | Whenever the field is non-nullable | `boolean`                                                                                 | No (default false) |
| args              | Object map of arguments            | [Argument type](#field-argument)                                                          | no                 |
| resolve           | Resolves field data                | `(source: TSource, args: TArgs, context: TContext, info: GraphQLResolveInfo) => TResult;` | No                 |
| subscribe         | Subscribe to field                 | `(source: TSource, args: TArgs, context: TContext, info: GraphQLResolveInfo) => TResult;` | No                 |
| deprecationReason | Reason why field is deprecated     | `string`                                                                                  | No                 |

> \* Either type or list is required.

#### Field list type

| Property | Description                        | Type                                                                        | Required |
| -------- | ---------------------------------- | --------------------------------------------------------------------------- | -------- |
| type     | `GraphQLList` type                 | [Output Type](#output-types) or `string` (a GraphQL type inside the schema) | Yes      |
| required | Whenever the field is non-nullable | `boolean`                                                                   | No       |

#### Field argument

| Property          | Description                       | Type                                                                      | Required |
| ----------------- | --------------------------------- | ------------------------------------------------------------------------- | -------- |
| type              | Type of the argument              | [Input type](#input-types) or `string` (a GraphQL type inside the schema) | No\*     |
| list              | List item type                    | [List type](#field-argument-list-type)                                    | No\*     |
| deprecationReason | Reason why argument is deprecated | `string`                                                                  | No       |

> \* Either type or list is required.

#### Field argument item type

| Property | Description                        | Type                                                                      | Required |
| -------- | ---------------------------------- | ------------------------------------------------------------------------- | -------- |
| type     | `GraphQLList` type                 | [Input type](#input-types) or `string` (a GraphQL type inside the schema) | Yes      |
| required | Whenever the field is non-nullable | `boolean`                                                                 | No       |

#### Input object field type

| Property          | Description                        | Type                                                                      | Required |
| ----------------- | ---------------------------------- | ------------------------------------------------------------------------- | -------- |
| type              | Type of the field                  | [Input type](#input-types) or `string` (a GraphQL type inside the schema) | No\*     |
| list              | List item type                     | [Item type](#input-object-field-item-type)                                | No\*     |
| required          | Whenever the field is non-nullable | `boolean`                                                                 | No       |
| defaultValue      | Default field value                | `unknown`                                                                 | No       |
| deprecationReason | Reason why argument is deprecated  | `string`                                                                  | No       |

> \* Either type or list is required.

#### Input object field item type

| Property | Description                        | Type                                                                      | Required |
| -------- | ---------------------------------- | ------------------------------------------------------------------------- | -------- |
| type     | `GraphQLList` type                 | [Input type](#input-types) or `string` (a GraphQL type inside the schema) | Yes      |
| required | Whenever the field is non-nullable | `boolean`                                                                 | No       |

## Example

### JSON schema

```javascript
const dateScalar = new GraphQLScalarType({
    name: "Date",
    description: "Date custom scalar type",
    /**
     * Convert outgoing Date to integer for JSON
     */
    serialize(value) {
        if (value instanceof Date) return value.getTime();
        throw Error("GraphQL Date Scalar serializer expected a `Date` object");
    },
    /**
     * Convert incoming integer to Date
     */
    parseValue(value) {
        if (typeof value === "number") return new Date(value); // Convert incoming integer to Date
        throw new Error("GraphQL Date Scalar parser expected a `number`");
    },
    /**
     * Convert hard-coded AST string to integer and then to Date
     */
    parseLiteral(ast) {
        if (ast.kind === Kind.INT) return new Date(parseInt(ast.value, 10));
        return null;
    },
});

const schemaInput = {
    brand: {
        description: "This is the brand of the car",
        type: GraphQLEnumType,
        values: {
            tesla: {description: "Tesla", value: "Tesla"},
            lightyear: {description: "Lightyear", value: "Lightyear"},
            volkwagen: {description: "Volkwagen", value: "Volkwagen"},
            porsche: {description: "Porsche", value: "Porsche"},
        },
    },
    carInput: {
        description: "This is the input for the create car mutation",
        type: GraphQLInputObjectType,
        fields: {
            description: {
                type: GraphQLString,
            },
            brand: {
                type: "brand",
                required: true,
            },
            price: {
                type: GraphQLFloat,
                defaultValue: 0,
            },
            tags: {
                list: {
                    type: GraphQLString,
                    required: true,
                },
                required: true,
            },
        },
    },
    car: {
        description: "This is the car itself",
        type: GraphQLInterfaceType,
        fields: {
            id: {
                type: GraphQLID,
                required: true,
            },
            description: {
                type: GraphQLString,
            },
            brand: {
                type: "brand",
                required: true,
            },
            price: {
                type: GraphQLFloat,
                required: true,
            },
            tags: {
                list: {
                    type: GraphQLString,
                    required: true,
                },
                required: true,
            },
            createdAt: {
                type: dateScalar,
                required: true,
            },
        },
    },
    electricCar: {
        description: "Electric engine car",
        type: GraphQLObjectType,
        interfaces: ["car"],
        fields: {
            id: {
                type: GraphQLID,
                required: true,
            },
            description: {
                type: GraphQLString,
            },
            brand: {
                type: "brand",
                required: true,
            },
            price: {
                type: GraphQLFloat,
                required: true,
            },
            tags: {
                list: {
                    type: GraphQLString,
                    required: true,
                },
                required: true,
            },
            createdAt: {
                type: dateScalar,
                required: true,
            },
            charge: {
                type: GraphQLFloat,
                required: true,
            },
        },
    },
    combustionCar: {
        description: "Combustion engine car",
        type: "object",
        interfaces: ["car"],
        fields: {
            id: {
                type: GraphQLID,
                required: true,
            },
            description: {
                type: GraphQLString,
            },
            brand: {
                type: "brand",
                required: true,
            },
            price: {
                type: GraphQLFloat,
                required: true,
            },
            tags: {
                list: {
                    type: GraphQLString,
                    required: true,
                },
                required: true,
            },
            createdAt: {
                type: dateScalar,
                required: true,
            },
            fuel: {
                type: GraphQLString,
                required: true,
            },
        },
    },
    carTypes: {
        description: "Any car",
        type: GraphQLUnionType,
        types: ["electricCar", "combustionCar"],
    },
    query: {
        description: "Queries",
        fields: {
            getCars: {
                description: "Get all cars",
                list: {
                    type: "carTypes",
                    required: true,
                },
                required: true,
            },
            getElectricCars: {
                description: "Get all electric engine cars",
                list: {
                    type: "electricCar",
                    required: true,
                },
                required: true,
            },
            getCombustionCars: {
                description: "Get all combustion engine cars",
                list: {
                    type: "combustionCar",
                    required: true,
                },
                required: true,
            },
            getCar: {
                description: "Get a car",
                type: "carTypes",
                args: {
                    id: {
                        type: GraphQLID,
                        required: true,
                    },
                },
            },
        },
    },
    mutation: {
        description: "Mutations",
        fields: {
            createCar: {
                description: "Create a car",
                type: "carTypes",
                args: {
                    car: {
                        type: "carInput",
                    },
                },
            },
        },
    },
};
```

### GraphQL schema

```
schema {
  query: query
  mutation: mutation
}

"""Queries"""
type query {
  """Get all cars"""
  getCars: [carTypes!]!

  """Get all electric engine cars"""
  getElectricCars: [electricCar!]!

  """Get all combustion engine cars"""
  getCombustionCars: [combustionCar!]!

  """Get a car"""
  getCar(id: ID!): carTypes
}

"""Any car"""
union carTypes = electricCar | combustionCar

"""Electric engine car"""
type electricCar implements car {
  id: ID!
  description: String
  brand: brand!
  price: Float!
  tags: [String!]!
  createdAt: Date!
  charge: Float!
}

"""This is the car itself"""
interface car {
  id: ID!
  description: String
  brand: brand!
  price: Float!
  tags: [String!]!
  createdAt: Date!
}

"""This is the brand of the car"""
enum brand {
  """Tesla"""
  tesla

  """Lightyear"""
  lightyear

  """Volkwagen"""
  volkwagen

  """Porsche"""
  porsche
}

"""Date custom scalar type"""
scalar Date

"""Combustion engine car"""
type combustionCar implements car {
  id: ID!
  description: String
  brand: brand!
  price: Float!
  tags: [String!]!
  createdAt: Date!
  fuel: String!
}

"""Mutations"""
type mutation {
  """Create a car"""
  createCar(car: carInput): carTypes
}

"""This is the input for the create car mutation"""
input carInput {
  description: String
  brand: brand!
  price: Float = 0
  tags: [String!]!
}
```
